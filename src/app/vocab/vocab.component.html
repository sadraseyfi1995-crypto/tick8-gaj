<div class="vocab-card" [class.flipped]="flipped" [class.old]="!areSameDay(vocab.lastUpdated)" tabindex="0"
  (click)="toggleFlip()" (keydown)="onCardKeydown($event)" role="button" [attr.aria-pressed]="flipped"
  aria-label="Vocabulary card. Press to flip to see answer.">
  <!-- Front Side -->
  <!-- Front Side -->
  <div class="side front">
    <button class="copy-btn" (click)="$event.stopPropagation(); copyCard()" title="Copy card as JSON"
      aria-label="Copy card">
      üìã
    </button>
    <button class="like-btn" (click)="toggleLike($event)" [class.liked]="vocab.liked"
      [title]="vocab.liked ? 'Unlike card' : 'Like card'" [attr.aria-label]="vocab.liked ? 'Unlike card' : 'Like card'">
      <span class="heart">{{ vocab.liked ? '‚ù§Ô∏è' : 'ü§ç' }}</span>
    </button>
    <div class="card-scroll-area">
      <div class="card-center-content">
        <div class="word" [title]="vocab.word">{{ vocab.word }}</div>

        <div class="boxes">
          <button *ngFor="let s of vocab.states; let i = index" class="box" [attr.data-state]="s"
            (click)="$event.stopPropagation(); cycleBox(i)"
            (keydown)="$event.stopPropagation(); onBoxKeydown($event, i)" role="checkbox"
            [attr.aria-checked]="getAriaChecked(s)" [attr.aria-label]="getAriaLabel(i, s)" title="Cycle state">
            <ng-container [ngSwitch]="s">
              <ng-container *ngSwitchCase="'tick'">
                <ng-container *ngTemplateOutlet="tickIcon"></ng-container>
              </ng-container>
              <ng-container *ngSwitchCase="'cross'">
                <ng-container *ngTemplateOutlet="crossIcon"></ng-container>
              </ng-container>
              <ng-container *ngSwitchCase="'boost'">
                <ng-container *ngTemplateOutlet="boostIcon"></ng-container>
              </ng-container>
            </ng-container>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Back Side -->
  <div class="side back">
    <div class="card-scroll-area">
      <div class="card-center-content">
        <div class="answer" [title]="vocab.answer">{{ vocab.answer }}</div>
      </div>
    </div>
  </div>
</div>

<!-- Icons Templates -->
<ng-template #tickIcon>
  <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
    <path d="M20 6L9 17l-5-5" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
      stroke-linejoin="round" />
  </svg>
</ng-template>

<ng-template #crossIcon>
  <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
    <path d="M18 6L6 18M6 6l12 12" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
      stroke-linejoin="round" />
  </svg>
</ng-template>

<ng-template #boostIcon>
  <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
    <path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
      stroke-linejoin="round" />
  </svg>
</ng-template>